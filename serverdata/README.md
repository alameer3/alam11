# قاعدة البيانات التجريبية - ServerData

## نظرة عامة
هذا المجلد يحتوي على نظام قاعدة البيانات التجريبية الكامل لمشروع AK.SV. تم تصميمه ليعمل بشكل مستقل وتلقائي عند تشغيل المشروع في Replit.

## هيكل المجلد

```
serverdata/
├── database.json           # قاعدة البيانات الرئيسية (JSON)
├── database-manager.js     # مدير قاعدة البيانات
├── init-database.js        # سكربت التهيئة التلقائية
├── config.js              # إعدادات النظام
├── images/                # مجلد الصور
│   ├── .gitkeep
│   └── [ملفات الصور]
├── backups/               # النسخ الاحتياطية (يتم إنشاؤها تلقائياً)
└── README.md             # هذا الملف
```

## الميزات الرئيسية

### 1. التهيئة التلقائية
- يتم تشغيل `init-database.js` تلقائياً عند بداية المشروع
- إنشاء قاعدة البيانات إذا لم تكن موجودة
- التحقق من سلامة البيانات وإصلاحها
- إنشاء مجلدات الصور والنسخ الاحتياطية

### 2. قاعدة البيانات الشاملة
قاعدة البيانات تحتوي على الجداول التالية:
- `users` - المستخدمون
- `categories` - الفئات
- `genres` - الأنواع
- `content` - المحتوى (أفلام، مسلسلات، إلخ)
- `episodes` - الحلقات
- `downloadLinks` - روابط التحميل
- `streamingLinks` - روابط المشاهدة
- `userFavorites` - المفضلات
- `userWatchHistory` - سجل المشاهدة
- `userComments` - التعليقات
- `userReviews` - المراجعات
- `userReviewLikes` - إعجابات المراجعات

### 3. إدارة الصور
- دعم لجميع أنواع الصور (SVG, PNG, JPG, إلخ)
- نظام placeholder للصور المفقودة
- تحسين الأداء للصور الكبيرة

### 4. النسخ الاحتياطية
- نسخ احتياطية تلقائية كل ساعة
- الاحتفاظ بـ 24 نسخة احتياطية
- إمكانية استعادة البيانات

## كيفية الاستخدام

### 1. التشغيل التلقائي
عند تشغيل المشروع في Replit، يتم تشغيل النظام تلقائياً:

```bash
# يتم تشغيل هذا تلقائياً
node serverdata/init-database.js
```

### 2. الاستخدام في الكود
```javascript
const { dbManager } = require('./serverdata/database-manager');

// الحصول على جميع الأفلام
const movies = await dbManager.getContent({ type: 'movie' });

// إضافة محتوى جديد
const newContent = await dbManager.createContent({
  title: 'فيلم جديد',
  type: 'movie',
  // ... باقي البيانات
});
```

### 3. إدارة الإعدادات
```javascript
const config = require('./serverdata/config');

// الحصول على مسار قاعدة البيانات
const dbPath = config.getDatabasePath();

// تحديث إعدادات الأمان
config.set('security', { enableBackups: true });
```

## البيانات التجريبية

### المحتوى الافتراضي
- **الأفلام**: 6 أفلام عربية وأجنبية
- **المسلسلات**: 6 مسلسلات مع حلقات
- **البرامج التلفزيونية**: 3 برامج
- **الألعاب**: 1 لعبة
- **البرامج**: 1 برنامج تعليمي
- **التطبيقات**: 1 تطبيق
- **المسرحيات**: 1 مسرحية
- **المصارعة**: 1 حدث مصارعة
- **الرياضة**: 1 حدث رياضي
- **المنوعات**: 3 عناصر متنوعة

### المستخدمون
- **المدير**: admin@aksvyemen.com (كلمة المرور: admin123)

### الفئات والأنواع
- **الفئات**: عربي، أجنبي
- **الأنواع**: أكشن، كوميديا، دراما، جريمة، إلخ

## الأمان والحماية

### 1. عزل البيانات
- جميع العمليات تتم داخل مجلد `serverdata` فقط
- لا يوجد اتصال بقواعد بيانات خارجية
- النظام معزول تماماً

### 2. النسخ الاحتياطية
- نسخ احتياطية تلقائية
- إمكانية استعادة البيانات في حالة الخطأ
- حماية من فقدان البيانات

### 3. التحقق من صحة البيانات
- التحقق من صحة البيانات عند التحميل
- إصلاح البيانات التالفة تلقائياً
- رسائل خطأ واضحة

## استكشاف الأخطاء

### 1. مشاكل شائعة
- **ملف قاعدة البيانات مفقود**: يتم إنشاؤه تلقائياً
- **مجلد الصور مفقود**: يتم إنشاؤه تلقائياً
- **بيانات تالفة**: يتم إصلاحها تلقائياً

### 2. سجلات النظام
```bash
# عرض سجلات التهيئة
node serverdata/init-database.js

# عرض حالة قاعدة البيانات
node -e "const config = require('./serverdata/config'); console.log(config.isConfigured())"
```

## المتطلبات التقنية

### 1. متطلبات النظام
- Node.js 14+
- مساحة تخزين: 100MB على الأقل
- ذاكرة: 512MB على الأقل

### 2. الاعتماديات
- `fs` - نظام الملفات
- `path` - مسارات الملفات
- `JSON` - معالجة البيانات

## التطوير والتحسين

### 1. إضافة محتوى جديد
```javascript
// إضافة فيلم جديد
const newMovie = await dbManager.createContent({
  title: 'فيلم جديد',
  titleArabic: 'فيلم جديد',
  type: 'movie',
  year: 2025,
  // ... باقي البيانات
});
```

### 2. تحديث الإعدادات
```javascript
// تحديث إعدادات النسخ الاحتياطية
config.set('database', {
  autoSave: true,
  backupInterval: 30 * 60 * 1000 // كل 30 دقيقة
});
```

## الدعم والمساعدة

لأي مشاكل أو استفسارات:
1. تحقق من سجلات النظام
2. راجع هذا الملف للحلول الشائعة
3. تأكد من أن جميع الملفات موجودة
4. أعد تشغيل سكربت التهيئة

---

**ملاحظة**: هذا النظام مصمم للعمل في بيئة Replit بشكل تلقائي وآمن. جميع البيانات محلية ولا تتطلب إعداد خارجي.